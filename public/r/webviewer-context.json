{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "webviewer-context",
  "type": "registry:lib",
  "description": "React context for WebViewer Core and DocumentViewer instances",
  "dependencies": [
    "@pdftron/webviewer"
  ],
  "registryDependencies": [
    "webviewer-types"
  ],
  "files": [
    {
      "path": "registry/context/webviewer-context.tsx",
      "content": "\"use client\";\n\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  type PropsWithChildren,\n} from \"react\";\nimport type { WebViewerContextValue } from \"@/lib/webviewer-types\";\n\nconst WebViewerContext = createContext<WebViewerContextValue>({\n  Core: null,\n  documentViewer: null,\n});\n\nexport type WebViewerProviderProps = PropsWithChildren<{\n  /**\n   * Path to the WebViewer worker files.\n   * Defaults to NEXT_PUBLIC_PDFTRON_PATH environment variable or \"/webviewer/lib\".\n   */\n  workerPath?: string;\n}>;\n\nexport const WebViewerProvider = ({\n  children,\n  workerPath = process.env.NEXT_PUBLIC_PDFTRON_PATH\n    ? `${process.env.NEXT_PUBLIC_PDFTRON_PATH}/core`\n    : \"/webviewer/lib/core\",\n}: WebViewerProviderProps) => {\n  // Initialize Core and DocumentViewer synchronously\n  // window.Core is guaranteed to exist since we're a child of LoadWebviewerCore\n  const [state] = useState(() => {\n    const CoreInstance = window.Core!;\n\n    CoreInstance.setWorkerPath(workerPath);\n    CoreInstance.enableFullPDF();\n\n    const docViewer = new CoreInstance.DocumentViewer();\n    docViewer.enableAnnotations();\n\n    return {\n      Core: CoreInstance,\n      documentViewer: docViewer,\n    };\n  });\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (state.documentViewer) {\n        try {\n          void state.documentViewer.closeDocument();\n        } catch {\n          // DocumentViewer might not have a document loaded\n        }\n      }\n    };\n  }, [state.documentViewer]);\n\n  return (\n    <WebViewerContext.Provider value={state}>\n      {children}\n    </WebViewerContext.Provider>\n  );\n};\n\nexport const useWebViewerContext = () => useContext(WebViewerContext);\n",
      "type": "registry:lib"
    }
  ]
}